<?xml version="1.0" encoding="UTF-8"?>
<excelConfig>
	<parameters>
		<!--保存时使用的模板,根据配置文件生成的excel,需要将数据保存为excel到本地,然后有save方法,再生成sql,保存到本地-->
		<parameter name="outputFilePath" value="C:\temo\OUT.xlsx" isShow="1"/>
		<!--<parameter isShow="1" name="template_FilePath" value="C:\00_Project\Jeesite070310\src\main\java\com\thinkgem\jeesite\common\excelConfig\test\xlsx\erp\enter\computer\computer.xlsx"/>-->
		<parameter isShow="1" name="template_FilePath" value="mouseAndKeyboard.xlsx"/>
		<parameter isShow="1" name="temlateSyntax" value="false"/>
	</parameters>
	<models cls="">
		<!--
			引用多数据源,
			配置了全局参数
		-->
		<!--查询-->
		<model  id="personQuery">
			<SQLStrs>
				<sqlStr>
					<![CDATA[
						SELECT EName, EmployeeID FROM IT_User WHERE LEFT(EmployeeID ,1)='Z' ORDER  BY EName
					]]>
				</sqlStr>
			</SQLStrs>
		</model>
		<!--保存-->
		<model  id="assetSave">
			<parameters >
				<parameter name="Status" class="java.lang.String"   value="$F!{Status}"/>
				<parameter name="QTY" class="java.lang.String"   value="$F!{QTY}"/>
				<parameter name="Type" class="java.lang.String"   value="$F!{Type}"/>
				<parameter name="StockCode" class="java.lang.String"      value="$F!{StockCode}"/>
				<parameter name="userid" class="java.lang.String" value="@@Userid"/>
			</parameters>
			<SQLStrs>
				<sqlStr>
					<![CDATA[
					   IF
							(SELECT count(*) 'count' FROM  IT_Asset WHERE Type='$P!{Type}')>0
						BEGIN
							UPDATE dbo.IT_Asset
							SET QTY = QTY+$P!{QTY}
							WHERE Type='$P!{Type}'
						END ELSE
						BEGIN
							INSERT INTO dbo.IT_Asset (id, StockCode,  Series, Type, SerialNo, QTY, Field2, create_by, create_date, update_by, update_date, remarks, del_flag)
							VALUES (newid(), '$P!{StockCode}',  '$P!{StockCode}', '$P!{Type}', '',  '$P!{QTY}','$P!{Status}','$P!{userid}', getdate(), '$P!{userid}', getdate(), NULL, '0')
						END


					]]>
				</sqlStr>
			</SQLStrs>
		</model>

		<model  id="transactionSave">
			<parameters >
				<parameter name="TransactionType" class="java.lang.String"      value="$F!{TransactionType}"/>
				<parameter name="beforeemployeeid" class="java.lang.String"   value="$F!{beforeemployeeid}"/>
				<parameter name="beforeemployeename" class="java.lang.String"   value="$F!{beforeemployeename}"/>
				<parameter name="qty" class="java.lang.String"   value="$F!{qty}"/>
				<parameter name="assettype" class="java.lang.String"   value="$F!{assettype}"/>
				<parameter name="userid" class="java.lang.String" value="@@Userid"/>
			</parameters>
			<SQLStrs>
				<sqlStr>
					<![CDATA[
					  INSERT INTO dbo.IT_Transaction (id, TransactionDate, TransactionType, beforeEmployeeID, beforeEmployeeName,currentEmployeeID,currentEmployeeName ,  QTY, assetType, Remark, create_by, create_date, update_by, update_date, remarks, del_flag)
VALUES (newid(), getdate(), '$P!{TransactionType}','$P!{beforeemployeeid}', '$P!{beforeemployeename}','', 'IT库房',  '$P!{qty}', '$P!{assettype}','',  '$P!{userid}', getdate(), '$P!{userid}', getdate(), '', '0')
			        ]]>
				</sqlStr>
			</SQLStrs>
		</model>
	</models>
	<!--查询视图-->
	<views   action="query">
		<view modelid="personQuery" sheetName="数据字典"   top="3" left="0">
			<propertys>
				<property 	cellIndex="0,1" feild="EmployeeID" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="EName" 	type="java.lang.String"/>
			</propertys>
		</view>
	</views>
	<!--保存视图-->
	<views   action="save">
		<view modelid="assetSave" sheetName="mouseAndKeyboard"  top="2" left="0">
			<propertys>
				<property cellIndex="0,1" feild="Status" required ="1"	type="java.lang.String" />
				<property cellIndex="0,3" feild="Type" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="StockCode" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="QTY" required ="-1"	type="java.lang.String" />
			</propertys>
		</view>
		<view modelid="transactionSave"  top="2" left="0">
			<propertys>
				<property 	cellIndex="0,1" feild="TransactionType" 	required ="-1" type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="beforeemployeeid" required ="-1"  type="java.lang.Number" />
				<property 	cellIndex="0,1"	feild="beforeemployeename" required ="-1"	type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="assettype" required ="-1"	type="java.lang.String" />
				<property 	cellIndex="0,2"	feild="qty" required ="1"	type="java.lang.String" />
			</propertys>
		</view>
	</views>
</excelConfig>