<?xml version="1.0" encoding="UTF-8"?>

<excelConfig>
	<parameters>
		<!--保存时使用的模板,根据配置文件生成的excel,需要将数据保存为excel到本地,然后有save方法,再生成sql,保存到本地-->
		<parameter name="outputFilePath" value="E:\test.xlsx"/>
		<parameter name="template_FilePath" value="C:\00_Project\Jeesite070310\src\main\java\com\thinkgem\jeesite\common\excelConfig\test\xlsx\DepartmentBudget.xlsx"/>
	</parameters>
	<models cls="">
		<!--
		自定义获取数据源

		获取部门的例子:
		部门		~~~~> 主管
				~~~~> 员工
		-->
		<model  id="ds">

			<SQLStrs>
				<sqlStr>
					<![CDATA[
					SELECT id 'departmentid', name FROM dbo.ZZDepartMent
					]]>
				</sqlStr>
			</SQLStrs>
		</model>
		<model  id="elist">
			<parameters>
				<parameter name="departmentid" value="$F!{departmentid}"/>
			</parameters>
			<SQLStrs>
				<sqlStr>
					<![CDATA[
				SELECT  name 'ename', salary FROM dbo.ZZEmployee WHERE departmentid = '$P!{departmentid}' and leavel='1'
					]]>
				</sqlStr>
			</SQLStrs>
		</model>

		<model  id="mlist">
			<parameters>
				<parameter name="departmentid" value="$F!{departmentid}"/>
			</parameters>
			<SQLStrs>
				<sqlStr>
					<![CDATA[
					SELECT  name 'ename', salary FROM dbo.ZZEmployee WHERE departmentid = '$P!{departmentid}' and leavel='0'
					]]>
				</sqlStr>
			</SQLStrs>
		</model>

	</models>
	<views    action="query">
		<view modelid="ds" sheetName="sheet1"   top="1" left="1">
			<propertys>
				<property 	cellIndex="0,1" feild="name" 	type="java.lang.String"  />
				<property 	cellIndex="0,1" feild="departmentid" 	type="java.lang.String"  />
			</propertys>
		</view>

		<view modelid="elist" sheetName="sheet1" ref="ds"   top="1" left="1">
			<propertys>
				<property 	cellIndex="0,1" feild="ename" 	type="java.lang.String"  />
				<property 	cellIndex="0,1" feild="salary"   type="java.lang.Number" />

			</propertys>
		</view>

		<view modelid="mlist" sheetName="sheet1" ref="ds"   top="1" left="1">
			<propertys>
				<property 	cellIndex="0,1" feild="ename" 	type="java.lang.String"  />
				<property 	cellIndex="0,1" feild="salary"   type="java.lang.Number" />
			</propertys>
		</view>
	</views>
</excelConfig>