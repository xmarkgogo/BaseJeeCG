<?xml version="1.0" encoding="UTF-8"?>
<excelConfig>
	<parameters>
		<!--保存时使用的模板,根据配置文件生成的excel,需要将数据保存为excel到本地,然后有save方法,再生成sql,保存到本地-->
		<parameter name="outputFilePath" value="C:\temo\OUT.xlsx" isShow="1"/>
		<!--<parameter isShow="1" name="template_FilePath" value="C:\00_Project\Jeesite070310\src\main\java\com\thinkgem\jeesite\common\excelConfig\test\xlsx\erp\enter\computer\computer.xlsx"/>-->
		<parameter isShow="1" name="template_FilePath" value="computer_reback.xlsx"/>
		<parameter isShow="1" name="temlateSyntax" value="false"/>
		<parameter isShow="0" name="assetSerialNo" class="java.lang.String" htmlType="input" desc="SN" isRequired="1" value="" modelId="" />
		<parameter isShow="0" name="EDP" class="java.lang.String" htmlType="input" desc="EDP" isRequired="1" value="" modelId="" />
		<parameter isShow="0" name="expressCode" class="java.lang.String" htmlType="input" desc="快速服务编码" isRequired="1" value="" modelId="" />

	</parameters>
	<models cls="">
		<!--
			引用多数据源,
			配置了全局参数
		-->
		<!--查询-->
		<model  id="computerDetailQuery">
			<SQLStrs>
				<sqlStr>
					<![CDATA[
						SELECT Series, CPU, HarddDisk, Display, Memory,type
						FROM  IT_Asset
						WHERE Type IN ('A1')
						GROUP BY Series, CPU, HarddDisk, Display, Memory,type
						ORDER BY Series
					]]>
				</sqlStr>
			</SQLStrs>
		</model>



		<!--根据条件记性查询-->
		<model  id="singleAssetQuery">
			<parameters>
				<parameter name="assetSerialNo" class="java.lang.String"  value="$P!{assetSerialNo}" />
				<parameter name="EDP" class="java.lang.String"  value="$P!{EDP}" />
				<parameter name="expressCode" class="java.lang.String"  value="$P!{expressCode}" />
			</parameters>
			<SQLStrs>
				<sqlStr>
					<![CDATA[

							SELECT * FROM IT_Asset WHERE 1=1 and type='A1'

							 <#if EDP = "" && assetSerialNo = "" && expressCode = "">
							 AND EDP is null
							</#if>
							<#if assetSerialNo?? && assetSerialNo != "">
							 AND SerialNo LIKE '%$P!{assetSerialNo}%'
							</#if>
							  <#if EDP?? && EDP != "">
							 AND EDP LIKE '%$P!{EDP}%'
							</#if>
							 <#if expressCode?? && expressCode != "">
							 AND expressCode LIKE '%$P!{expressCode}%'
							</#if>
					]]>
				</sqlStr>
			</SQLStrs>
		</model>
		<!--保存-->
		<model  id="assetSave">
			<parameters >
				<parameter name="StockCode" class="java.lang.String"      value="$F!{StockCode}"/>
				<parameter name="EDP" class="java.lang.String"   value="$F!{EDP}"/>
				<parameter name="Series" class="java.lang.String"   value="$F!{Series}"/>
				<parameter name="Type" class="java.lang.String"   value="$F!{Type}"/>
				<parameter name="SerialNo" class="java.lang.String"   value="$F!{SerialNo}"/>
				<parameter name="ExpressCode" class="java.lang.String"   value="$F!{ExpressCode}"/>
				<parameter name="CPU" class="java.lang.String"   value="$F!{CPU}"/>
				<parameter name="HarddDisk" class="java.lang.String"   value="$F!{HarddDisk}"/>
				<parameter name="Display" class="java.lang.String"   value="$F!{Display}"/>
				<parameter name="Memory" class="java.lang.String"   value="$F!{Memory}"/>
				<parameter name="Power" class="java.lang.String"   value="$F!{Power}"/>
				<parameter name="Battery" class="java.lang.String"   value="$F!{Battery}"/>
				<parameter name="DVD" class="java.lang.String"   value="$F!{DVD}"/>
				<parameter name="ReceivedDate" class="java.lang.String"   value="$F!{ReceivedDate}"/>
				<parameter name="ComputerName" class="java.lang.String"   value="$F!{ComputerName}"/>
				<parameter name="WarrantyStart" class="java.lang.String"   value="$F!{WarrantyStart}"/>
				<parameter name="WarrantyEnd" class="java.lang.String"   value="$F!{WarrantyEnd}"/>
				<parameter name="QTY" class="java.lang.String"   value="$F!{QTY}"/>
				<parameter name="DisplaySN" class="java.lang.String"   value="$F!{DisplaySN}"/>
				<parameter name="systemVersion" class="java.lang.String"   value="$F!{systemVersion}"/>
				<parameter name="Status" class="java.lang.String"   value="$F!{Status}"/>
				<parameter name="ComputerName" class="java.lang.String"   value="$F!{ComputerName}"/>
				<parameter name="Field4" class="java.lang.String"   value="$F!{Field4}"/>
				<parameter name="Field3" class="java.lang.String"   value="$F!{Field3}"/>
				<parameter name="userid" class="java.lang.String" value="@@USERID"/>
			</parameters>
			<SQLStrs>
				<sqlStr>
					<![CDATA[
						IF
							(SELECT count(*) FROM IT_Asset WHERE SerialNo IN ('$P!{SerialNo}'))>0
						BEGIN
							UPDATE IT_Asset SET Field2='$P!{Status}' WHERE SerialNo = '$P!{SerialNo}'
						END ELSE
						BEGIN
							 INSERT INTO dbo.IT_Asset (StockCode,EDP,Field2,Field5,Field3,Field4,id,  Series, Type, SerialNo, ExpressCode, CPU, HarddDisk, Display, Memory,    ReceivedDate,ComputerName, WarrantyStart, WarrantyEnd, QTY, create_by, create_date, update_by, update_date, remarks, del_flag)
										VALUES ('$P!{StockCode}','$P!{EDP}','$P!{Status}','$P!{systemVersion}','$P!{Field3}','$P!{Field4}',newid(), '$P!{Series}', 'A1', '$P!{SerialNo}', '$P!{ExpressCode}', '$P!{CPU}', '$P!{HarddDisk}', '$P!{Display}', '$P!{Memory}', '$P!{ReceivedDate}',  '$P!{ComputerName}', '$P!{WarrantyStart}', '$P!{WarrantyEnd}', $P!{QTY}, '$P!{userid}', getdate(), '$P!{userid}', getdate(), '', '0')
						END
			        ]]>
				</sqlStr>
			</SQLStrs>
		</model>


	</models>
	<!--查询视图-->
	<views   action="query">
		<view modelid="computerDetailQuery" sheetName="数据字典"   top="3" left="0">
			<propertys>
				<property 	cellIndex="0,1" feild="Series" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="CPU" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="HarddDisk" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="Display" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="Memory" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="type" 	type="java.lang.String"/>
			</propertys>
		</view>
		<view modelid="personQuery" sheetName="数据字典"   top="2" left="6">
			<propertys>
				<property 	cellIndex="0,1" feild="EName" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="EmployeeID" 	type="java.lang.String"/>
			</propertys>
		</view>

		<view modelid="singleAssetQuery" sheetName="电脑采购入库单"   top="2" left="3">
			<propertys>
				<property 	cellIndex="0,1" feild="QTY" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="SerialNo" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="Type" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="Series" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="CPU" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="Display" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="Memory" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="HarddDisk" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="ExpressCode" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="EDP" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="Field5" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="ReceivedDate" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="WarrantyStart" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="WarrantyEnd" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="ComputerName" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="Field4" 	type="java.lang.String"/>
				<property 	cellIndex="0,1" feild="Field3" 	type="java.lang.String"/>
			</propertys>
		</view>
	</views>
	<!--保存视图-->
	<views   action="save">
		<view modelid="assetSave" sheetName="电脑采购入库单"  top="2" left="0">
			<propertys>
				<property cellIndex="0,1" feild="Status" required ="1"	type="java.lang.String" />
				<property cellIndex="0,3" feild="QTY" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="SerialNo" required ="1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="StockCode" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="Series" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="CPU" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="Display" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="Memory" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="HarddDisk" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="ExpressCode" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="ExpressCode" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="systemVersion" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="ReceivedDate" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="WarrantyStart" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="WarrantyEnd" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="ComputerName" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="Field4" required ="-1"	type="java.lang.String" />
				<property cellIndex="0,1" feild="Field3" required ="-1"	type="java.lang.String" />
			</propertys>
		</view>
	</views>
</excelConfig>