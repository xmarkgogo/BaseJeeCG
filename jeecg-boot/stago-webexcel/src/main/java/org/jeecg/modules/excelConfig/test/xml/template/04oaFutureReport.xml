<?xml version="1.0" encoding="UTF-8"?>

<excelConfig>
	<parameters>
		<!--保存时使用的模板,根据配置文件生成的excel,需要将数据保存为excel到本地,然后有save方法,再生成sql,保存到本地-->
		<parameter name="outputFilePath" value="E:\test.xlsx"/>
		<parameter name="template_FilePath" isShow="1" value="04oaFutureReport.xlsx"/>
		<parameter name="departmentid" class="java.lang.String" htmlType="select" isShow="0" desc="部门"  value="" modelId="departmentList"/>
		<parameter name="employeeid" class="java.lang.String" htmlType="select" isShow="0" desc="人员" value="" modelId="employeeList"/>
	</parameters>
	<models cls="com.thinkgem.jeesite.common.excelConfig.impl.getCusModel">
		<!--
		自定义获取数据源
		请假的例子
		-->
		<model  id="ds">
			<SQLStrs>
				<sqlStr>
					<![CDATA[

					]]>
				</sqlStr>
			</SQLStrs>
		</model>

		<!---->
		<model  id="departmentList">
			<parameter name="departmentid" class="java.lang.String"  value="$F!{departmentid}" />
			<SQLStrs>
				<sqlStr>
					<![CDATA[
						SELECT a.id 'value',a.name 'name' FROM sys_office a
					]]>
				</sqlStr>
			</SQLStrs>
		</model>

		<model  id="employeeList">
			<parameter name="employeeid" class="java.lang.String"  value="$F!{employeeid}" />
			<SQLStrs>
				<sqlStr>
					<![CDATA[
						SELECT a.id 'value',a.name 'name' FROM sys_user a WHERE a.login_flag='1' AND a.del_flag='0' AND LEFT(no,1)='Z'  ORDER BY a.name
					]]>
				</sqlStr>
			</SQLStrs>
		</model>

	</models>
	<views    action="query">
		<view modelid="ds" sheetName="sheet1"   top="1" left="1">
			<propertys>
				<property 	cellIndex="0,1" feild="Day" 	type="java.lang.Integer"  />
				<property 	cellIndex="0,1" feild="Month"   type="java.lang.String" />
				<property 	cellIndex="0,1" feild="Week"   type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="Name" 	type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="AbsenceType" 	type="java.lang.String" />
			</propertys>
		</view>
	</views>
</excelConfig>