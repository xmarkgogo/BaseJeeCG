<?xml version="1.0" encoding="UTF-8"?>
<excelConfig>
	<parameters>
		<!--template_FilePath:模板文件的路径，如果使用模板，则View中配置的TOP LEFT 不起作用，排版的方式完全依赖模板中的内容-->
		<parameter name="template_FilePath" value="IT.xlsx"/>
		<!-- outputFilePath：文件输出的路径，不允许为空-->
		<parameter name="outputFilePath" value="E:\\OUT.xlsx"/>
		<parameter name="temlateSyntax" value="false"/>
		<!--
        parameter中的属性具体含义
        htmlType[input/select]//类型选择项:下拉框/文本输入框/单选框/日期选择
        isRequired;//是否是必填项 默认为非必填:
        			0:必填
        			1:非必填
		isShow;//是否在webexcel中显示对应的参数 默认为不显示:
        			0:现实
        			1:不显示
        desc //描述,webexcel中筛选框的描述信息
        modelId//对应数据源的id: 从xml中的model中获取对应id的数据源当htmlType为Select/radio下拉框时候提供数据支持

        -->
		<parameter name="lizhi" value="" isRequired="0"   isShow="0" desc="档案内容"  htmlType="select" modelId="selectDateSource" />

	</parameters>

	<WebExcleView  JsSource="">
		<!--<Plus  cellRange="Q5:Q1000"             CellType="GroupList"                        modelid="OrgUserList" cls="" />-->

		<!--
		 CellType：支持Combo  DatePicker CheckBoxList  GroupList UnLockCell 如果其他格式，定制ComponentPlus.js
		 由于WebExcel不能设置单独锁定某一个单元格，所以如果需要锁定某些单元格而另外一些单元格可以编辑，需要将整个sheet锁定，然后指定某几个单元格的属性为：UnLockCell
		 cellRange 支持混排模式 支持区间模式D1:D10 支持列模式 E不指定数字后缀代表E这一整列
		 cls配置的是专门用来处理数据的Java类
		 modelid
		 带有上下级的关系树，  必须含有字段 ID-PID-text-value-order(排序可选)
		 普通的数据源        必须含有字段text-value-name 默认情况 name=text
		-->
	</WebExcleView>

	

	<!--
     models 块
     cls属性->值为一个Java类，需要实现com.thinkgem.jeesite.common.excelConfig.exector.ModelsInterFace 接口的getDataSource 方法
     一旦实现后，实现类将接管models处理方法,返回的是数据集
    -->
	<models cls="com.thinkgem.jeesite.common.excelConfig.impl.implEmp">
	    
	  	<model  id="selectDateSource">
			<SQLStrs>
				<sqlStr>
					<![CDATA[
                     SELECT   '在职' name,'在职' value
                     UNION
                     SELECT   '离职','离职'

					]]>
				</sqlStr>
			</SQLStrs>
		</model>
	    


		<model  id="T_OBJ_TYPE_REL_Query">
			<parameters>
				<parameter name="P1" class="java.lang.String" value="$P!{lizhi}"/>
			</parameters>
			<SQLStrs>
				<!--
                sqlStr块
                此内容块中，可以配置一条或者多条SQL语句，如果需要使用参数，必须使用$P!前缀且必须用{}进行包裹model块中的 parameter中的name引用
                例如，此句中，因为使用参数用户ID，则使用'$P!{userid}'进行引用， userid在parameter块中进行了配置
                -->
				<sqlStr>
					<![CDATA[
						SELECT * FROM T_OBJ_TYPE_REL  WHERE  F_TYPEID = 'A0'
						<#if  P1 == "在职">  AND  F_PAR71  ='1900/01/01' </#if>
		             	<#if  P1 == "离职">  AND  F_PAR71 !='1900/01/01' </#if>
				    	order by F_PAR10 DESC
					]]>
				<!--
					SQL 中采用 freeMaker 语法标记语言，可以直接进行变量替换
					<#if Sno?? && Sno != ""> WHERE Sno ='$P!{Sno}' </#if>
					代表含义为Sno变量为NULL或者变量值不是空值的时候，才能在语句中执行下面的内容
                 -->

				</sqlStr>
			</SQLStrs>
		</model>



		<!---保存模块-->
		<model  id="T_OBJ_TYPE_REL_SAVE">
			<parameters >

				<parameter name="F_ID"         class="java.lang.String"   value="$F!{B}"/>
				<parameter name="F_USEOBJID"   class="java.lang.String"   value="$F!{B}"/>

				<parameter name="F_PAR34"  class="java.lang.String"   value="$F!{F_PAR34}"/>
				<parameter name="F_PAR35"  class="java.lang.String"   value="$F!{F_PAR35}"/>
				<parameter name="F_PAR66"  class="java.lang.String"   value="$F!{F_PAR66}"/>
				<parameter name="F_PAR65"  class="java.lang.String"   value="$F!{F_PAR65}"/>
				<parameter name="F_PAR67"  class="java.lang.String"   value="$F!{F_PAR67}"/>
				<parameter name="F_PAR37"  class="java.lang.String"   value="$F!{F_PAR37}"/>


			</parameters>
			<SQLStrs>
				<sqlStr>
		<![CDATA[
			UPDATE T_OBJ_TYPE_REL SET
				 F_PAR34='$P!{F_PAR34}'
				,F_PAR35='$P!{F_PAR35}'
				,F_PAR66='$P!{F_PAR66}'
				,F_PAR65='$P!{F_PAR65}'
				,F_PAR67='$P!{F_PAR67}'
				,F_PAR37='$P!{F_PAR37}'
			WHERE F_USEOBJID='$P!{F_USEOBJID}'
		]]>
				</sqlStr>
			</SQLStrs>
		</model>
	</models>

	<views   action="query">
		<view modelid="T_OBJ_TYPE_REL_Query" sheetName="IT基础信息"   top="3" left="0">
			<propertys>
				<property 	cellIndex="0,0" feild="F_PAR1" 	    type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR2"  	type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR3"   	type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR4" 	    type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR5"   	type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR6" 	    type="java.lang.String" />



				<property 	cellIndex="0,1"	feild="F_PAR10"     type="java.lang.String" />
				<property 	cellIndex="0,1" feild="F_PAR11"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR12"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR13"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR14"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR15"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR16"     type="java.lang.String" />

				<property 	cellIndex="0,1"	feild="F_PAR34"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR35"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR66"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR65"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR67"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR37"     type="java.lang.String" />

			</propertys>
		</view>

    </views>

	<views   action="save">
		<view modelid="T_OBJ_TYPE_REL_SAVE" sheetName="IT基础信息"   top="3" left="0">
			<propertys>
				<property 	cellIndex="0,0" feild="A"      type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="B"  	   type="java.lang.String" required="1"/>

				<property 	cellIndex="0,12"	feild="F_PAR34"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR35"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR66"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR65"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR67"     type="java.lang.String" />
				<property 	cellIndex="0,1"	feild="F_PAR37"     type="java.lang.String" />
			</propertys>
		</view>
	</views>

</excelConfig>